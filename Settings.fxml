<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.PasswordField?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane styleClass="main-container" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.dormitory.controllers.SettingsViewController">
    <padding>
        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
    </padding>
    <left>
        <VBox fx:id="navMenu" prefHeight="512.0" prefWidth="221.0" spacing="10.0" style="-fx-background-color: #ffffff; -fx-padding: 10; -fx-border-color: #e0e0e0; -fx-border-width: 0 1 0 0;">
            <children>
                <Button onAction="#showChangePasswordView" prefWidth="200.0" styleClass="settings-nav-button" text="Change Password" />
                <Button onAction="#showPrivacyView" prefWidth="200.0" styleClass="settings-nav-button" text="Privacy and Security" />
                <Button fx:id="backupButton" onAction="#showBackupView" prefWidth="200.0" styleClass="settings-nav-button" text="Backup and Restore" />
                <Button onAction="#showAboutView" prefWidth="200.0" styleClass="settings-nav-button" text="About" />
                <Separator />
                <Button fx:id="logoutButton" onAction="#handleLogout" prefWidth="200.0" styleClass="danger-button" text="Logout" />
            </children>
        </VBox>
    </left>
    <center>
        <StackPane fx:id="settingsContentPane" style="-fx-background-color: #ffffff; -fx-padding: 20;">
            <BorderPane.margin>
                <Insets left="20.0" />
            </BorderPane.margin>
            <children>
                <!-- Change Password View -->
                <VBox fx:id="changePasswordView" prefHeight="416.0" prefWidth="752.0" spacing="15.0">
                    <Label styleClass="section-title" text="Change Your Password" />
                    <VBox maxWidth="400.0" spacing="10.0">
                        <Label styleClass="form-label" text="Current Password:" />
                        <PasswordField fx:id="currentPasswordField" styleClass="form-field" />
                        <Label styleClass="form-label" text="New Password:" />
                        <PasswordField fx:id="newPasswordField" styleClass="form-field" />
                        <Label styleClass="form-label" text="Confirm New Password:" />
                        <PasswordField fx:id="confirmPasswordField" styleClass="form-field" />
                        <HBox alignment="CENTER_RIGHT">
                            <Button onAction="#changePassword" styleClass="primary-button" text="Save Password" />
                        </HBox>
                    </VBox>
                </VBox>
                <!-- Privacy View -->
                <VBox fx:id="privacyView" spacing="10.0" visible="false">
                    <Label styleClass="section-title" text="My Activity Log" />
                    <TableView fx:id="auditLogTable" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn fx:id="colAction" prefWidth="150.0" text="Action" />
                            <TableColumn fx:id="colDescription" prefWidth="300.0" text="Description" />
                            <TableColumn fx:id="colIpAddress" prefWidth="120.0" text="IP Address" />
                            <TableColumn fx:id="colTimestamp" prefWidth="180.0" text="Timestamp" />
                        </columns>
                        <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY" /></columnResizePolicy>
                    </TableView>
                </VBox>
                <!-- Backup View -->
                <VBox fx:id="backupView" spacing="20.0" visible="false">
                    <Label styleClass="section-title" text="Backup and Restore" />
                    <Label text="Create a backup of the entire database or restore it from a file. This action should be performed with caution." wrapText="true" />
                    <HBox spacing="10.0">
                        <Button onAction="#handleBackup" styleClass="primary-button" text="Backup Database" />
                        <Button onAction="#handleRestore" styleClass="danger-button" text="Restore from File" />
                    </HBox>
                </VBox>
                <!-- About View -->
                <VBox fx:id="aboutView" spacing="10.0" visible="false">
                    <Label styleClass="section-title" text="About Dormitory Management System" />
                    <Label text="Version: 1.0.0" />
                    <Label text="Developed by: Mohammed Oumer" />
                    <Label text="This application helps manage student and proctor information, room assignments, and reporting within a dormitory." wrapText="true" />
                </VBox>
            </children>
        </StackPane>
    </center>
</BorderPane>
